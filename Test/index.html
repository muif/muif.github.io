<!DOCTYPE html>
<html>
<head>
    <title>دمج بيانات العملاء</title>
    <style>
        // ... (أنماط CSS)
    </style>
</head>
<body>
    // ... (HTML)

    <script>
        // ... (متغيرات ودوال)

        async function دمج_البيانات(xlsxFile, csvFile) {
            // ... (بقية الكود)

            mergedData = mergeData(xlsxData, csvData); // تخزين البيانات المدمجة
            console.log('mergedData:', mergedData);
            displayResult(mergedData);
        }

        // ... (بقية الدوال)

        window.onload = async function() {
            try {
                const xlsxResponse = await fetch('all_customers.xlsx');
                const xlsxBlob = await xlsxResponse.blob();
                const xlsxFile = new File([xlsxBlob], 'all_customers.xlsx');

                const csvResponse = await fetch('partner.csv');
                const csvBlob = await csvResponse.blob();
                const csvFile = new File([csvBlob], 'partner.csv');

                console.log('xlsxFile:', xlsxFile);
                console.log('csvFile:', csvFile);

                if (xlsxFile && csvFile) {
                    await دمج_البيانات(xlsxFile, csvFile);
                }
            } catch (error) {
                console.error('Error loading files:', error);
                alert('Error loading files. Please ensure the files are in the same directory and try again.');
            }
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</body>
</html>
