<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>National Geographic - Pro Cast Player</title>
    
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <link href="https://unpkg.com/@videojs/themes@1.0.1/dist/city/index.css" rel="stylesheet">
    
    <link href="https://unpkg.com/@silvermine/videojs-chromecast@1.5.0/dist/silvermine-videojs-chromecast.css" rel="stylesheet">

    <style>
        body { background-color: #000; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .container { width: 90%; max-width: 1000px; border: 2px solid #ffcc00; border-radius: 12px; overflow: hidden; position: relative; }
        .video-js { width: 100%; height: auto; aspect-ratio: 16/9; }
        
        /* تخصيص لون أيقونة الكاست لتبدو ذهبية */
        .vjs-chromecast-button .vjs-icon-placeholder:before { color: #ffcc00; }
        
        .channel-logo {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 80px;
            z-index: 10;
            opacity: 0.8;
            pointer-events: none;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="channel-logo">
        <svg viewBox="0 0 100 30" xmlns="http://www.w3.org/2000/svg">
            <rect width="20" height="30" fill="#ffcc00"/>
            <text x="25" y="22" fill="white" font-size="14" font-weight="bold">NAT GEO</text>
        </svg>
    </div>

    <video id="my-video" class="video-js vjs-theme-city" controls preload="auto">
        <p class="vjs-no-js">للمشاهدة، يرجى تفعيل جافا سكريبت.</p>
    </video>
</div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
<script src="https://unpkg.com/@silvermine/videojs-chromecast@1.5.0/dist/silvermine-videojs-chromecast.min.js"></script>

<script>
    const videoUrl = "https://admn-live-cdn-lb.starzplayarabia.com/out/v1/admn_tv_enc/national_geo/national_geo_hls_nd/index_ngeo_video_enc_480p25.m3u8";
    const audioUrl = "https://admn-live-cdn-lb.starzplayarabia.com/out/v1/admn_tv_enc/national_geo/national_geo_hls_nd/index_ngeo_audio_enc_ara.m3u8";

    // بناء الـ Master Playlist لدمج الصوت والصورة
    const masterPlaylist = `#EXTM3U
#EXT-X-MEDIA:TYPE=AUDIO,GROUP-ID="audio",NAME="Arabic",DEFAULT=YES,AUTOSELECT=YES,URI="${audioUrl}"
#EXT-X-STREAM-INF:BANDWIDTH=1280000,RESOLUTION=854x480,AUDIO="audio"
${videoUrl}`;

    const blob = new Blob([masterPlaylist], { type: 'application/x-mpegURL' });
    const blobUrl = URL.createObjectURL(blob);

    // إعداد المشغل مع خاصية الـ Chromecast
    var player = videojs('my-video', {
        fluid: true,
        playbackRates: [0.5, 1, 1.5, 2],
        plugins: {
            chromecast: {
                addButtonToControlBar: true, // إضافة زر الكاست لشريط التحكم
            }
        },
        controlBar: {
            children: [
                'playToggle',
                'volumePanel',
                'currentTimeDisplay',
                'progressControl',
                'liveDisplay',
                'playbackRateMenuButton',
                'chromecastButton', // زر البث
                'pictureInPictureToggle', // ميزة الصورة داخل صورة
                'fullscreenToggle',
            ],
        }
    });

    player.src({
        src: blobUrl,
        type: 'application/x-mpegURL'
    });

</script>

</body>
</html>
