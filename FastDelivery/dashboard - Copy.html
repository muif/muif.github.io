<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± ÙØ§Ø³Øª Ø¯Ù„ÙŠÙØ±ÙŠ (Firebase)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f6f8; padding: 20px; text-align: right; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #4361ee; margin-top: 0; }
        .btn { 
            background: #4361ee; color: white; border: none; padding: 12px 25px; 
            border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; 
            width: 100%; transition: 0.2s;
        }
        .btn:hover { background: #304ffe; transform: translateY(-2px); }
        .status-box { margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px; color: #0d47a1; display: none; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
        .order-card { 
            background: white; border: 1px solid #eee; padding: 15px; margin-top: 15px; 
            border-radius: 10px; border-right: 5px solid #00b894; 
            animation: slideIn 0.3s ease; display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="container">
        <h2>ğŸš€ Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±Ø¹Ø© Ø§Ù„Ø§ØªØµØ§Ù„</h2>
        <p>Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ù„Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø³ÙŠØ±ÙØ±Ø§Øª Ø¬ÙˆØ¬Ù„ (Ø£Ù„Ù…Ø§Ù†ÙŠØ§) ÙˆØ§Ø³ØªÙ‚Ø¨Ø§Ù„Ù‡ ÙÙˆØ±Ø§Ù‹.</p>
        
        <button class="btn" id="addBtn">â• Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
        <div id="status" class="status-box"></div>

        <hr style="margin: 25px 0; border: 0; border-top: 1px dashed #ccc;">
        
        <h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ© (Real-time):</h3>
        <div id="ordersContainer">
            <p style="color:#777; text-align:center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
        </div>
    </div>

    <script type="module">
        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…Ù† Ø³ÙŠØ±ÙØ±Ø§Øª Ø¬ÙˆØ¬Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ (ØªÙ… Ù†Ø³Ø®Ù‡Ø§ Ù…Ù† Ø±Ø³Ø§Ù„ØªÙƒ)
        const firebaseConfig = {
            apiKey: "AIzaSyCWukKBntaP3j-3OeVFJnuMEyXV2uJ_qfI",
            authDomain: "fastdelivery-app-e7a69.firebaseapp.com",
            projectId: "fastdelivery-app-e7a69",
            storageBucket: "fastdelivery-app-e7a69.firebasestorage.app",
            messagingSenderId: "749882364658",
            appId: "1:749882364658:web:461f02b223b02e09f5766b"
        };

        // 1. ØªØ´ØºÙŠÙ„ ÙØ§ÙŠØ±Ø¨ÙŠØ³
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const ordersRef = collection(db, "orders"); // Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„

        // 2. Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¹Ù†Ø¯ Ø¶ØºØ· Ø§Ù„Ø²Ø±
        document.getElementById('addBtn').addEventListener('click', async () => {
            const btn = document.getElementById('addBtn');
            const status = document.getElementById('status');
            
            btn.disabled = true; 
            btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";
            
            try {
                await addDoc(ordersRef, {
                    customer_name: "Ø¹Ù…ÙŠÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠ " + Math.floor(Math.random() * 1000),
                    amount: 5000 + Math.floor(Math.random() * 10000),
                    status: "New",
                    created_at: serverTimestamp() // ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø³ÙŠØ±ÙØ±
                });
                
                status.style.display = 'block';
                status.innerText = "âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!";
                setTimeout(() => status.style.display = 'none', 2000);
            } catch (error) {
                alert("Ø®Ø·Ø£: " + error.message);
                console.error(error);
            }
            
            btn.disabled = false;
            btn.innerText = "â• Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯";
        });

        // 3. Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª (Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø³Ø­Ø±!)
        // Ø£ÙŠ ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ø¯Ø§ØªØ§Ø¨ÙŠØ³ Ø³ÙŠØµÙ„ Ù‡Ù†Ø§ ÙÙˆØ±Ø§Ù‹
        const q = query(ordersRef, orderBy("created_at", "desc"));
        
        onSnapshot(q, (snapshot) => {
            const container = document.getElementById('ordersContainer');
            container.innerHTML = ''; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©

            if (snapshot.empty) {
                container.innerHTML = '<p style="text-align:center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>';
                return;
            }

            snapshot.forEach(doc => {
                const data = doc.data();
                const card = `
                    <div class="order-card">
                        <div>
                            <strong>${data.customer_name}</strong>
                            <div style="font-size:12px; color:#666; margin-top:5px;">${data.status}</div>
                        </div>
                        <div style="font-weight:bold; color:#4361ee;">
                            ${data.amount} Ø¯.Ø¹
                        </div>
                    </div>
                `;
                container.innerHTML += card;
            });
        });
    </script>
</body>
</html>